---
title: "Pitcher Plant Inquiline Communities"
subtitle: "Exploring the diversity of Saracenia purpurea"
author: "Kristen Howard"
institute: "terHorst Lab"
date: "(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: inverse
 # Outline of Presentation
 
 
--
1. Brief Introduction into Carnivious Plants and their Feeding Mechanisms


--
2. Model System - Sarracenia purpurea


--
3. Data/Exploration

---
class: inverse
![](https://www.syfy.com/sites/syfy/files/2020/06/audrey2.jpg)

--
class: inverse, center, middle
**There are over 700 species of carnivorous plants around the world!**

**.red[The feeding mechanism is very rare!]**

---
class: inverse, center, middle

# Model System - Pitcher Plant Fun

---

# Model System

I am interested in the inquiline community of Sarracenia Purpurea

.center[
<img src= "https://www.fs.usda.gov/wildflowers/plant-of-the-week/images/purplepitcherplant/SAPU4.gif",, width="50%"/>]

.footnote[[source](https://www.fs.usda.gov/wildflowers/plant-of-the-week/sarracenia_purpurae.shtml)]

---
# Feeding Mechanism

.center[<img src= "https://www.gardenia.net/storage/app/public/uploads/images/detail/75e09eb820b5dba9b3a7117a6ea98346.webp", width=80%/>]

.footnote[[(terHorst 2010)](https://onlinelibrary.wiley.com/doi/10.1111/j.1420-9101.2010.02140.x)]
---

# Questions
--


- What is the abundance of the organisms seen in purple pitcher plants?


--
- Which Organisms have the highest abundances?

--
- Does the number of organisms seen depend on the age of the leaf?

---
# Data Collection

We found 100 leaf bodies and measured the following information:

![Screenshot](libs\Images\data_dic.PNG)
---
# Data Sheet


![Screenshot](libs\Images\datasheet_screenshot.PNG)
---
#Load Packages
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
library(ggplot2)
library(crosstable)
library(dplyr)
library(vtable)
library(gganimate)
library(hrbrthemes)
library(viridis)
library(ggridges)
library(ggpubr)
library(rcartocolor)
library(DT)
library(plotly)
```

---
class: center, middle

# Load Data
```{r, message = TRUE}
pitcher_plant_data <- read.csv(here("Data/pitcher_plant_data.csv"))
```
# Create Color Pallate
```{r}
my_pal <- rcartocolor::carto_pal(n = 8, name = "Bold")[c(1, 3, 7, 2,4,5,6,8)]
```

---
# General Plot showing Abundances
```{r, table1, warning=FALSE, message=FALSE}
pitcher_plant_data %>%
  group_by(Plant.ID.Alpha) %>% # Group by the specific plant ID
  select(ants,spiders,beetle,other.prey,Mosquito) %>% # Select variables of interest
  summarise_at(vars("ants":"Mosquito"),  mean, na.rm = TRUE) %>% # Calculates mean of selected columns
  kable() %>% # Creates table
  kable_styling(full_width = T)
```

---
# Marginal Plot

.pull-up[
```{r, plot1, fig.path="../Output/", eval=FALSE, warning=FALSE, message=FALSE}
pitcher_plant_data %>%
      ggscatterhist( x = "leaf_age_", 
                     y = "ants",
                     color = "Plant.ID.Alpha", 
                     size = 3, 
                     alpha = 0.6,
        palette = my_pal,
        margin.plot = "boxplot",
        xlab = "Number of Ants",
        ylab = "Age of Leaf (Days)",
        title = "Ant Abundances Over Time",
        ggtheme = theme_bw() 
        )
```
]
.pull-down[
```{r plot1-out, ref.label="plot1", echo=FALSE}
```
]

---
# Specefic Plant ID Exploration
First, we must convert the columns of interest into numerics (they are currently characters)
# Next, calculate the sum of organisms for Plant Numeric ID 1
```{r}

pitch_A1 <- pitcher_plant_data %>%
              filter(Plant.ID.Numeric == "1")
```
---
# Create graph
.pull-right[
```{r, plot3, eval=FALSE, warning=FALSE, message=FALSE}
# pitch_A1 %>%
#        filter(Plant.ID.Alpha == "A")
#        ggplot(aes(x=leaf_age_, # select x variable of interest
#                   y=Total_organisms,
#                   color = Plant.ID.Alpha)) + # select y variable of interest
#   labs(title = "Total Organisms ", # Label title
#        x = "Age of Leaf", # Label X-axis
#        y = "Total Organisms") + # Label Y-axis
#         geom_boxplot() +
#         geom_point(aes(color = Plant.ID.Alpha))+
#         theme_minimal()
```
]
.pull-left[
```{r plot3-out, ref.label="plot3", echo=FALSE}
```
]

---
# Ridgeline Distrinution Plot
This is showing the number of mites of leaf age

.pull-right[
```{r, wave-label, eval=FALSE, warning=FALSE, message=FALSE}
g_ridges <- 
  ggplot(pitcher_plant_data, aes(leaf_age_, fct_rev(Plant.ID.Alpha), color = Plant.ID.Alpha, fill = Plant.ID.Alpha)) + 
  coord_cartesian(clip = "off") +
  scale_y_discrete(expand = c(.07, .07)) +
  scale_color_manual(values = my_pal, guide = "none") +
  scale_fill_manual(values = my_pal, guide = "none") +
  labs(x = "Leaf Age (Days)",
       y = "Plant ID Alpha") + 
  ggtitle("Organism Distribution Over Time") +
  theme_minimal()

g_ridges +
  ggridges::geom_density_ridges(
    alpha = .7, size = 1.5
  )
```
]
.pull-left[
```{r plot-label-out, ref.label="wave-label", echo=FALSE, warning=FALSE, message=FALSE}
```
]

---
# Box Plot
```{r}
# Summary statistics
Plant_summary <- pitcher_plant_data %>% # Select df
      group_by(Plant.ID.Alpha) %>% # Group by variable of interest
      summarise(ants_sd = sd(ants, na.rm = TRUE), ants_mean = mean(ants)) # Calculate sd and mean of the ant abundances
     Plant_summary # View table
```

---
```{r, bar_label}
Plant_summary %>%
  ggplot(aes(x = Plant.ID.Alpha, # Select x variable
              y = ants_mean)) + # Select y variable
   geom_bar(stat = "identity", 
            fill = my_pal,  # Use custom palatte
            color = "black") + # Outline of the bar
   geom_errorbar(aes(ymin = ants_mean,  # Set the minimum y value to the mean of the ants
                     ymax = ants_sd), # Set the maximum y value to the sd of the ants
                     width = 0.2) +
      theme_minimal() + # select theme
      coord_flip() + # Flip 
  labs( y= "Average Number of Ants", # label Y-axis
        x = "Plant ID") # label X-axis
    

```

---
class: center, middle, inverse
# Thank you
# Questions?
![Screenshot](libs\Images\kristen.sarracenia.PNG)
