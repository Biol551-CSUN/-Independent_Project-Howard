---
title: "Pitcher Plant Inquiline Communities"
subtitle: "Exploring the diversity of Saracenia purpurea"
author: "Kristen Howard"
institute: "terHorst Lab"
date: "(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: inverse
![](https://www.syfy.com/sites/syfy/files/2020/06/audrey2.jpg)

--
class: inverse, center, middle
**There are over 700 species of carnivorous plants around the world!**

**.red[The feeding mechanism is very rare!]**

---
 # Outline of Presentation
 
 
--
1. Brief Introduction into Carnivious Plants and their Feeding Mechanisms


--
2. Model System - Sarracenia purpurea


--
3. Data/Exploration


---
class: inverse, center, middle

# Model System - Pitcher Plant Fun

---

# Model System

I am interested in the inquiline community of Sarracenia Purpurea

.center[
<img src= "https://www.fs.usda.gov/wildflowers/plant-of-the-week/images/purplepitcherplant/SAPU4.gif",, width="50%"/>]

.footnote[[source](https://www.fs.usda.gov/wildflowers/plant-of-the-week/sarracenia_purpurae.shtml)]

---
# Feeding Mechanism

.center[<img src= "https://www.gardenia.net/storage/app/public/uploads/images/detail/75e09eb820b5dba9b3a7117a6ea98346.webp", width=80%/>]

.footnote[[(terHorst 2010)](https://onlinelibrary.wiley.com/doi/10.1111/j.1420-9101.2010.02140.x)]
---

# Questions
--


- What is the abundance of the organisms seen in purple pitcher plants?


--
- Which Organisms have the highest abundances?

--
- Does the number of organisms seen depend on the age of the leaf?

---
# Data Collection

We found 100 leaf bodies and measured the following information:


![Screenshot](libs\Images\datasheet_screenshot.PNG)

---
# Data Collection

![Screenshot](libs\Images\datasheet_screenshot.PNG)


---
#Load Packages
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
library(ggplot2)
library(crosstable)
library(dplyr)
library(vtable)
library(gganimate)
library(hrbrthemes)
library(viridis)
library(ggridges)
library(ggpubr)
library(rcartocolor)
library(DT)
```

---
class: center, middle

# Load Data
```{r, message = TRUE}
library(here)
pitcher_plant_data <- read.csv(here("Data/pitcher_plant_data.csv"))
view(pitcher_plant_data)
```
# Create Color Pallate
```{r}
my_pal <- rcartocolor::carto_pal(n = 8, name = "Bold")[c(1, 3, 7, 2,4,5,6,8)]
```


---
# Marginal Plot

.pull-up[
```{r,plot-label, eval=FALSE, warning=FALSE, message=FALSE}
pitcher_plant_data %>%
      ggscatterhist( x = "leaf_age_", 
                     y = "ants",
                     color = "Plant.ID.Alpha", 
                     size = 3, 
                     alpha = 0.6,
        palette = my_pal,
        margin.plot = "boxplot",
        ggtheme = theme_bw()
        )
```
]
.pull-down[
```{r wave-label-out, ref.label="wave-label", echo=FALSE}
```
]
---

#Lets look at one particular plant ID and the number of organisms over the age the leaf

First, we must convert the columns of interest into numerics (they are currently characters)
```{r}
#Convert columns to numeric
pitcher_plant_data$Mites <- as.numeric(pitcher_plant_data$Mites)

### rotifers and after are characters, change to numeric
```

# Next, calculate the sum of organisms for Plant Numeric ID 1
```{r}
pitcher_plant_data$Total_organisms <- 

rowSums(pitcher_plant_data[,c("ants","spiders","beetle","Mosquito","Midges","Snot","Mites")])
```
---
# Create graph
.pull-right[
```{r, plot3, eval=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

ggplot(pitcher_plant_data, aes(x=leaf_age_,
                               y=Total_organisms)) + 
  geom_line() +
  labs(title = "Total Organisms Over Time in Plant A",
       x = "Age of Leaf", 
       y = "Total Organisms") 
```
]
.pull-left[
```{r plot3-out, ref.label="plot3", echo=FALSE}
```
]

---
# Ridgeline Distrinution Plot
This is showing the number of mites of leaf age

.pull-right[
```{r, wave-label, eval=FALSE, warning=FALSE, message=FALSE}
g_ridges <- 
  ggplot(pitcher_plant_data, aes(leaf_age_, fct_rev(Plant.ID.Alpha), color = Plant.ID.Alpha, fill = Plant.ID.Alpha)) + 
  coord_cartesian(clip = "off") +
  scale_y_discrete(expand = c(.07, .07)) +
  scale_color_manual(values = my_pal, guide = "none") +
  scale_fill_manual(values = my_pal, guide = "none") +
  labs(x = "Leaf Age (Days)",
       y = "Plant ID Alpha") + 
  ggtitle("Organism Distribution Over Time") +
  theme_minimal()

g_ridges +
  ggridges::geom_density_ridges(
    alpha = .7, size = 1.5
  )
```
]
.pull-left[
```{r plot-label-out, ref.label="wave-label", echo=FALSE, warning=FALSE, message=FALSE}
```
]


---
# Summary Stats
```{r}
# Summary statistics
df.summary <- pitcher_plant_data %>%
  group_by(Plant.ID.Alpha) %>%
  summarise(ants_sd = sd(ants, na.rm = TRUE), ants_mean = mean(ants))
df.summary
```

---
```{r, bar_label}
df.summary %>%
  ggplot(aes(x = Plant.ID.Alpha, 
              y = ants_mean)) +
   geom_bar(stat = "identity", 
            fill = my_pal, 
            color = "black") +
   geom_errorbar(aes(ymin = ants_mean, 
                     ymax = ants_sd), 
                     width = 0.2) +
      theme_minimal() +
      coord_flip() +
  labs( y= "Average Number of Ants",
        x = "Plant ID")
    

```

---
# Thank you
![Screenshot](libs\Images\datasheet_screenshot.PNG)
